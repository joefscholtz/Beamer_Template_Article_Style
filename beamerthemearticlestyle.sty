\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{beamertheme}[2025/12/12 Custom Beamer Theme]

\RequirePackage{microtype}
\RequirePackage{etoolbox}
\RequirePackage[T1]{fontenc}
\RequirePackage{sourcesanspro} 

\mode<presentation>

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Colors
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Primary Brand Colors
\definecolor{cardinalred}{RGB}{140,21,21} 
\definecolor{coolgrey}{RGB}{77,79,83} 
\definecolor{lightgrey}{HTML}{f8f8f8} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Beamer General Settings
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Itemize Bullet Colors
\setbeamercolor{itemize item}{fg=black}
\setbeamercolor{itemize subitem}{fg=black}
\setbeamercolor{itemize subsubitem}{fg=black}
\setbeamercolor{section head}{fg=cardinalred}

% Itemize Bullet Shapes
\setbeamertemplate{itemize item}[circle]
\setbeamertemplate{itemize subitem}{{\textendash}}
\setbeamertemplate{itemize subsubitem}[triangle]

% Navigation Symbols (Adding page numbers)
\addtobeamertemplate{navigation symbols}{}{%
    \usebeamerfont{footline}%
    \usebeamercolor[fg]{footline}%
    \hspace{1em}%
    \insertframenumber/\inserttotalframenumber
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Frame Title 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\setbeamerfont{frametitle}{series=\scshape}
\setbeamercolor{frametitle}{fg=black}

\setbeamertemplate{frametitle}{   
    \vspace*{-2mm}
    \begin{center}
        \footnotesize
        \inserttitle
    \end{center}
    \vspace*{-2mm}
    % Logic to handle section vs frame titles
    \ifdefempty{\insertsectionhead}{%
        \ifdefempty{\insertframetitle}{}{%
            \textbf{-- }\insertframetitle
        }%
    }{%
        \ifdefempty{\insertframetitle}{}{%
            \textbf{\large{\insertframetitle}\newline}
            \textcolor{cardinalred}{\normalsize{\insertsectionhead}}
        }%
    }
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Section Divider Slides
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\AtBeginSection[]{
  \begin{frame}
  \vfill
  \centering
  \begin{beamercolorbox}[sep=8pt,center]{title}
    {\usebeamerfont{title}\usebeamercolor[fg]{frametitle}{\textsc{\insertsectionnumber\protect~\text{.}\insertsectionhead}}}\par%
  \end{beamercolorbox}
  \vfill
  \end{frame}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Title Page
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\setbeamertemplate{title page}[default][left] 

% Font Settings
\setbeamerfont{subtitle}{series=\scshape}
\setbeamercolor{subtitle}{fg=black}
\setbeamerfont{author}{family=\sourcesanspro}
\setbeamercolor{author}{fg=black}
\setbeamercolor{institute}{fg=cardinalred}
\setbeamercolor{email}{fg=coolgrey}

% Email handling
% Initialize @email to avoid errors if user doesn't define it
\def\@email{} 
\newcommand{\email}[1]{\def\@email{\texttt{\MakeLowercase{\textls[10]{#1}}}}}

% Custom Title Page Template
\defbeamertemplate*{title page}{customized}[1][]
{
    \begin{tikzpicture}[remember picture, overlay]
        \coordinate (CircleCenter) at ([xshift=0, yshift=0cm]current page.center);
        
        % [fill=colorname!alpha]
        \fill[fill=coolgrey!10] (CircleCenter) circle (8cm);
        
        \fill[fill=white] (CircleCenter) circle (6cm);
    \end{tikzpicture}

    \center{
      \usebeamerfont{title}\textls[100]{\MakeUppercase{\textbf{\inserttitle}}}\par
      \usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\textls[100]{\textsc{\insertsubtitle}}\par\par
    }
    \vfill
    \usebeamerfont{institute}{\usebeamercolor[fg]{institute}\textls[100]{\textsc{\insertinstitute}}}\par
    \usebeamerfont{author}\usebeamercolor[fg]{author}\textls[100]{\textsc{\insertauthor}}\par
    \bigskip
    {\usebeamercolor[fg]{email}\@email}\par
    \usebeamerfont{date}\insertdate\par
    \usebeamercolor[fg]{titlegraphic}\inserttitlegraphic
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Table of contents
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\def\@toctittle{Table of Contents}
\newcommand{\toctittle}[1]{
  \def\@toctittle{#1}
}
\newcommand{\inserttoctittle}{
    \@toctittle
}

% style of section presented in the table of contents
\setbeamertemplate{section in toc}{%
  \tikz{\draw[fill=blue!20] (0,0) circle (3pt);}\hspace{2mm}\inserttocsection\par
      {\usebeamerfont{subtitle}\usebeamercolor[fg]{frametitle}{\textsc{\inserttocsection\protect~\text{.}\insertsectionhead}}}\par%

}
\setbeamertemplate{subsection in toc}{%
  \tikz{\draw[fill=blue!20] (0,0) circle (3pt);}\hspace{2mm}\inserttocsection\par
}


% avoid numbering of frames that are breaked into multiply slides
\setbeamertemplate{frametitle continuation}{}


\mode<all>

